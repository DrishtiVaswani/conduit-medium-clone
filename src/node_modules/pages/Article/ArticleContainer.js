import React, { useEffect } from 'react';
import { connect } from 'react-redux';
import PropTypes from 'prop-types';

import { fetchArticle, fetchComments } from './actions';
import Article from './Article';
import { articleSelector, commentsSelector } from './selector';

function ArticleContainer({ match, fetchArticle, article, fetchComments, comments }) {

    const { slug } = match.params;

    useEffect(() => {
        fetchArticle(slug);
        fetchComments(slug);
    }, [fetchArticle, fetchComments, slug]);

    return (
        <Article {...article} comments={comments}/>
    );
}

ArticleContainer.propTypes = {
    fetchArticle: PropTypes.func.isRequired,
    article: PropTypes.object.isRequired,
    fetchComments: PropTypes.func.isRequired,
    comments: PropTypes.object.isRequired,
};

const mapStateToProps = (state) => ({
    article: articleSelector(state),
    comments: commentsSelector(state),
});

const mapDispatchToProps = {
    fetchArticle,
    fetchComments,
};

export default connect(mapStateToProps, mapDispatchToProps)(ArticleContainer);