import React from 'react';
import PropTypes from 'prop-types';
import { connect } from 'react-redux';
import { Redirect } from 'react-router-dom';
import { Form, Input, Button, Checkbox } from 'antd';

import Layout from 'components/Layout';
import { userLoginFetch } from 'actions/auth';

import './login.scss';

function Login({ userLoginFetch, isFetching, error, isAuthenticated }) {

    const handleSubmit = ({ email, password }) => {
        userLoginFetch(email, password);
    };

    if (isAuthenticated) {
        return <Redirect to="/" />
    }

    return (
        <Layout>
            <section className="login">
                <div className="login-heading">
                    <h1>Войти</h1>
                    <p>Быстро и легко.</p>
                </div>
                <Form
                    initialValues={{ remember: true }}
                    onFinish={handleSubmit}
                >
                    <Form.Item
                        name="email"
                        rules={[{ required: true, message: 'Please input your email!' }]}
                    >
                        <Input
                            type="email"
                            placeholder="Электронный адрес"
                            size="large"
                        />
                    </Form.Item>

                    <Form.Item
                        name="password"
                        rules={[{ required: true, message: 'Please input your password!' }]}
                    >
                        <Input.Password
                            type="password"
                            placeholder="Пароль"
                            size="large"
                        />
                    </Form.Item>

                    <Form.Item
                        name="remember"
                    >
                        <Checkbox>Remember me</Checkbox>
                    </Form.Item>

                    <Form.Item>
                        <Button
                            type="primary"
                            htmlType="submit"
                            loading={isFetching}
                            size="large"
                            block
                        >
                            Войти
                        </Button>
                    </Form.Item>
                </Form>
            </section>
        </Layout>
    );
}

Login.propTypes = {
    userLoginFetch: PropTypes.func.isRequired,
    isFetching: PropTypes.bool.isRequired,
    isAuthenticated: PropTypes.bool.isRequired,
};

const mapStateToProps = (state) => ({
    isFetching: state.auth.isFetching,
    error: state.auth.error,
    isAuthenticated: state.auth.isAuthenticated,
});

const mapDispatchToProps = {
    userLoginFetch,
};

export default connect(mapStateToProps, mapDispatchToProps)(Login);