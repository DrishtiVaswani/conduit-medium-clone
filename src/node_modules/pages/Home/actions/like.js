import {
    POST_LIKE_REQUEST,
    POST_LIKE_SUCCESS,
    POST_LIKE_FAILURE,
    DELETE_LIKE_REQUEST,
    DELETE_LIKE_SUCCESS,
    DELETE_LIKE_FAILURE,
} from '../actionTypes';
import { defaultErrorMessage } from '../constants';
import Api from 'api';

const likeRequest = () => ({
    type: POST_LIKE_REQUEST,
});

const likeSuccess = (data) => ({
    type: POST_LIKE_SUCCESS,
    payload: data,
});
const likeFailure = (errorMessage = defaultErrorMessage) => ({
    type: POST_LIKE_FAILURE,
    payload: errorMessage,
});

export const like = (slug) => async (dispatch) => {

    dispatch(likeRequest());

    const response = await Api.Articles.like(slug);

    if (response.data.article) {
        dispatch(likeSuccess(response.data));
    }

    if (response.data.errors) {
        dispatch(likeFailure(response.data.errors));
    }

    return response;
};

const unlikeRequest = () => ({
    type: DELETE_LIKE_REQUEST,
});

const unlikeSuccess = (data) => ({
    type: DELETE_LIKE_SUCCESS,
    payload: data,
});
const unlikeFailure = (errorMessage = defaultErrorMessage) => ({
    type: DELETE_LIKE_FAILURE,
    payload: errorMessage,
});

export const unlike = (slug) => async (dispatch) => {

    dispatch(unlikeRequest());

    const response = await Api.Articles.unlike(slug);

    if (response.data.article) {
        dispatch(unlikeSuccess(response.data));
    }

    if (response.data.errors) {
        dispatch(unlikeFailure(response.data.errors));
    }

    return response;
};