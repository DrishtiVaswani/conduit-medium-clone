import React, { useState } from 'react';
import { connect } from 'react-redux';
import { Button } from 'evergreen-ui';

import { like, unlike } from '../pages/Home/actions/like';

import './Like.scss';

function Like({ favorited, favoritesCount, slug, like, unlike }) {

    const [isFetching, setIsFetching] = useState(false);

    const handleClick = (event) => {
        event.preventDefault();
        if (!favorited) {
            setIsFetching(true);
            like(slug).then((response) => {
                setIsFetching(false);
            });
        } else {
            setIsFetching(true);
            unlike(slug).then((response) => {
                setIsFetching(false);
            })
        }
    };

    return (
        <Button
            appearance="primary"
            intent={!favorited ? 'success' : 'danger'}
            iconBefore={isFetching ? null : !favorited ? 'heart' : 'heart-broken'}
            isLoading={isFetching}
            onClick={handleClick}
        >
            <span>{favoritesCount}</span>
        </Button>
    );
}

const mapStateToProps = (state) => ({

});

const mapDispatchToProps = {
    like,
    unlike,
};

export default connect(mapStateToProps, mapDispatchToProps)(Like);