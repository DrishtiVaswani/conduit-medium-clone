import axios from 'axios';

const Api = axios.create({
    baseURL: process.env.REACT_APP_BASE_URL,
    headers: {
        'Authorization': `Token ${localStorage.getItem('jwt')}`,
        'Content-Type': 'application/json',
        'Accept': 'application/json'
    }
});

const baseUrl = 'https://conduit.productionready.io/api';
const token = localStorage.getItem('jwt');

const requests = {
    del: url => fetch(`${baseUrl}${url}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json;charset=utf-8',
            'Authorization': `Token ${token}`,
        }
    }).then(response => response.json()),

    get: (url) => fetch(`${baseUrl}${url}`, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json;charset=utf-8',
            'Authorization': `Token ${token}`,
        }
    }).then(response => response.json()),

    put: (url, body) => fetch(`${baseUrl}${url}`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json;charset=utf-8',
            'Authorization': `Token ${token}`,
        },
        body: JSON.stringify(body),
    }).then(response => response.json()),

    post: (url, body) => fetch(`${baseUrl}${url}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json;charset=utf-8',
            'Authorization': `Token ${token}`,
        },
        body: JSON.stringify(body),
    }).then(response => response.json()),
};

const Profile = {
    follow: (username) => requests.post(`/profiles/${username}/follow`),
    get: (username) => requests.get(`/profiles/${username}`),
    unfollow: (username) => requests.del(`/profiles/${username}/follow`)
};

const Articles = {
    like: (slug) => requests.post(`/articles/${slug}/favorite`),
    unlike: (slug) => requests.del(`/articles/${slug}/favorite`),
};

export default {
    Profile,
    Articles,
};